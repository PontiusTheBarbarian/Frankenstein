version: '1'

variables:
- name: 'SOLUTION_FILE'
  value: 'Test.sln'
- name: 'WEB_API_NAME'
  value: 'Api'
- name: 'WEB_API_DIR'
  value: 'src/Api'

templates:
  create-solution:
    engine: 'dotnet'
    command: 'new serv-sln'
    arguments: '--allow-scripts=yes'
  create-webapi:
    engine: 'dotnet'
    command: 'new serv-webapi'
    arguments: '--output=$(WEB_API_DIR) -dock -key -aud -auth=BasicAuth'
  create-webapi-unit-tests:
    engine: 'dotnet'
    command: 'new nunit'
    arguments: '--output=tests/$(WEB_API_NAME).Unit.Tests'
  create-azuredevops-pipeline:
    engine: 'dotnet'
    command: 'new serv-cicd'
    arguments: '-ca -dep --solution=$(SOLUTION_FILE) --web-api=$(WEB_API_DIR)/$(WEB_API_NAME).csproj -scn=PAYG-SERVICE-CONN -webn=LATESTWEBAPI123 -rgn=LATESTTEMPLATE'
  add-cake-tool:
    engine: 'dotnet'
    command: 'new serv-cake'
    arguments: '-nu --solution=$(SOLUTION_FILE) --web-api=$(WEB_API_DIR)/$(WEB_API_NAME).csproj'