version: '1'

variables:
- name: 'SOLUTION_FILE'
  value: 'TestFolder.sln'
- name: 'WEB_API_NAME'
  value: 'Api'
- name: 'WEB_API_DIR'
  value: 'src/Api'

templates:
  create-solution:
    engine: 'dotnet'
    command: 'new serv-sln'
    arguments: '--allow-scripts=yes'
  create-webapi:
    engine: 'dotnet'
    command: 'new serv-webapi'
    arguments: '--output=$(WEB_API_DIR) -auth=BasicAuth -dock -key -aud'
  create-webapi-unit-tests:
    engine: 'dotnet'
    command: 'new nunit'
    arguments: '--output=tests/$(WEB_API_NAME).Unit.Tests'
  add-cake-tool:
    engine: 'dotnet'
    command: 'new serv-cake'
    arguments: '--solution=$(SOLUTION_FILE) --web-api=$(WEB_API_DIR)/$(WEB_API_NAME).csproj -nu'
  create-azuredevops-pipeline:
    engine: 'dotnet'
    command: 'new serv-cicd'
    arguments: '--solution=$(SOLUTION_FILE) --web-api=$(WEB_API_DIR)/$(WEB_API_NAME).csproj --web-api-name=$(WEB_API_NAME)-123 --service-connection-name=PAYG-SERVICE-CONN resource-group-name=LATESTTEMPLATE -ca -dep'
  run-setup:
    shell: 'setup.cmd'